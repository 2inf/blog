<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Ray Tracing In One Weekend | 2inf</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/blog/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><!-- modified--><link rel="stylesheet" type="text/css" href="/blog/css/atom-one-dark.min.css?v=0.0.0"><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script><!----><link rel="alternate" type="application/atom+xml" href="/blog/atom.xml"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Ray Tracing In One Weekend</h1><a id="logo" href="/blog/.">2inf</a><p class="description">wtyangのスペース(spread nonsense)</p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> 首页</i></a><a href="/blog/archives/" target="_self"><i class="fa fa-archive"> 归档</i></a><a href="/blog/tags/" target="_self"><i class="fa fa-tags"> 标签</i></a><a href="/blog/about/" target="_self"><i class="fa fa-user"> 关于</i></a><a href="https://2inf.top/note/" target="_self"><i class="fa fa-book"> 笔记</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-4-4"><div class="content_container"><div class="post"><h1 class="post-title">Ray Tracing In One Weekend</h1><div class="post-meta">2023-11-12<span> | </span><span class="category"><a href="/blog/categories/Graphics/">Graphics</a></span></div><div class="post-content"><h1 id="overview-概述">Overview 概述</h1>
<p>  本文是对 Peter Shirley 的《Ray Tracing In One
Weekend》的学习笔记，主要是为了加深对光线追踪的理解，以及对 C++
的熟悉程度。项目官方地址：<a
href="https://raytracing.github.io/books/RayTracingInOneWeekend.html">Ray
Tracing in One
Weekend</a>，官方源码：https://github.com/RayTracing/raytracing.github.io/
。</p>
<h1 id="output-an-image-输出图像">Output an Image 输出图像</h1>
<h2 id="ppm-文件格式">PPM 文件格式</h2>
<p>  图像信息写入文件，使用最简单的 ppm 文件，关于 portable pixmap
format (PPM), 见 <a
href="https://en.wikipedia.org/wiki/Netpbm_format#PPM_example">wiki</a>。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Image</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> image_width = <span class="number">256</span>;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> image_height = <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Render</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"P3\n"</span> &lt;&lt; image_width &lt;&lt; <span class="string">' '</span> &lt;&lt; image_height &lt;&lt; <span class="string">"\n255\n"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; image_height; ++j) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">clog</span> &lt;&lt; <span class="string">"\rScanlines remaining: "</span> &lt;&lt; (image_height - j) &lt;&lt; <span class="string">' '</span> &lt;&lt; <span class="built_in">std</span>::flush;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; image_width; ++i) &#123;</span><br><span class="line">			<span class="keyword">auto</span> r = <span class="keyword">double</span>(i) / (image_width - <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">auto</span> g = <span class="keyword">double</span>(j) / (image_height - <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">auto</span> b = <span class="number">0.25</span>;</span><br><span class="line">			<span class="comment">/*</span></span><br><span class="line"><span class="comment">			int ir = static_cast&lt;int&gt;(255.999 * r);</span></span><br><span class="line"><span class="comment">			int ig = static_cast&lt;int&gt;(255.999 * g);</span></span><br><span class="line"><span class="comment">			int ib = static_cast&lt;int&gt;(255.999 * b);</span></span><br><span class="line"><span class="comment">			*/</span></span><br><span class="line">			<span class="keyword">auto</span> to_int = [](<span class="keyword">double</span> x) &#123; <span class="keyword">return</span> <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">255.999</span> * x); &#125;;</span><br><span class="line">			<span class="keyword">auto</span> ir = to_int(r), ig = to_int(g), ib = to_int(b);</span><br><span class="line"></span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ir &lt;&lt; <span class="string">' '</span> &lt;&lt; ig &lt;&lt; <span class="string">' '</span> &lt;&lt; ib &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">clog</span> &lt;&lt; <span class="string">"\rDone.			\n"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建图像文件">创建图像文件</h2>
<p>  在项目目录下创建 <code>main.cpp</code>，并将上述代码复制进去，使用
<code>g++</code> 编译运行，生成 <code>a.exe</code>，运行
<code>a.exe</code>，生成 <code>a.ppm</code>，使用 <code>ppm</code>
查看器打开 <code>a.ppm</code>，得到如下图像。</p>
<h2 id="加入进度提示">加入进度提示</h2>
<h1 id="the-vec3-class-三维向量类">The vec3 Class 三维向量类</h1>
<h1 id="rays-a-simple-camera-and-background-简单相机和背景">Rays, a
Simple Camera, and Background 简单相机和背景</h1>
<h1 id="adding-a-sphere-球体">Adding a Sphere 球体</h1>
<h1 id="surface-normals-and-multiple-objects-表面法线和多个物体">Surface
Normals and Multiple Objects 表面法线和多个物体</h1>
<h1 id="moving-canera-code-into-a-class-将相机代码移入类">Moving Canera
Code into a Class 将相机代码移入类</h1>
<h1 id="antialiasing-抗锯齿">Antialiasing 抗锯齿</h1>
<h1 id="diffuse-materials-漫反射材质">Diffuse Materials 漫反射材质</h1>
<h1 id="metal-金属材质">Metal 金属材质</h1>
<h1 id="dielectrics-介质">Dielectrics 介质</h1>
<h1 id="positionable-camera-可定位相机">Positionable Camera
可定位相机</h1>
<h1 id="defocus-blur-散焦模糊">Defocus Blur 散焦模糊</h1>
<h1 id="where-next-下一步做什么">Where Next? 下一步做什么？</h1>
</div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/blog/css/copyright.css"><!--pspan= __('copyright_title_prefix')
= page.title--><p><span>文章作者：</span>wtyang</p><!--pspan= __('copyright_date_prefix')
= page.date.format(config.date_format)--><!--pspan= __('copyright_update_prefix')
= page.updated.format(config.date_format)--><p><span>原始链接：</span><a href="/Graphics/RayTracingInOneWeekend/">https://2inf.top/blog/Graphics/RayTracingInOneWeekend/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://2inf.top/blog/Graphics/RayTracingInOneWeekend/"></i></span></p><p><span>版权声明：</span>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="noopener">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a> 许可协议。转载请注明出处！</p></div><br><div class="tags"></div><div class="post-nav"><a class="next" href="/blog/Others/Hexo-record/">Hexo 记录</a></div></div></div></div><div class="pure-u-1 pure-u-md-4-4"><div id="footer">Copyright © 2023 <a href="/blog/." rel="nofollow">2inf</a>&nbsp;|&nbsp;<a href="http://www.beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">湘ICP备20012049号-1 </a>|&nbsp;
<a href="/blog/atom.xml" target="_blank"><i class="fa fa-rss"></i>&nbsp;RSS Feed</a><div><link rel="stylesheet" type="text/css" href="/blog/css/badge.css"/><div class="github-badge"><a rel="nofollow" target="_blank" href="https://hexo.io"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hexo</span></a></div>
<div class="github-badge"> <a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"><span class="badge-subject">Theme</span><span class="badge-value bg-orange">maupassant</span></a></div>
<div class="github-badge"> <a rel="nofollow" target="_blank" href="https://www.cnblogs.com/2inf/"><span class="badge-subject">cnblogs</span><span class="badge-value bg-blueviolet">2inf</span></a></div></div></div></div></div><div class="post-toc"><div class="post-toc-wrap"><div class="post-toc" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#overview-概述"><span class="toc-number">1.</span> <span class="toc-text">Overview 概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#output-an-image-输出图像"><span class="toc-number">2.</span> <span class="toc-text">Output an Image 输出图像</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ppm-文件格式"><span class="toc-number">2.1.</span> <span class="toc-text">PPM 文件格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建图像文件"><span class="toc-number">2.2.</span> <span class="toc-text">创建图像文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#加入进度提示"><span class="toc-number">2.3.</span> <span class="toc-text">加入进度提示</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#the-vec3-class-三维向量类"><span class="toc-number">3.</span> <span class="toc-text">The vec3 Class 三维向量类</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rays-a-simple-camera-and-background-简单相机和背景"><span class="toc-number">4.</span> <span class="toc-text">Rays, a
Simple Camera, and Background 简单相机和背景</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#adding-a-sphere-球体"><span class="toc-number">5.</span> <span class="toc-text">Adding a Sphere 球体</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#surface-normals-and-multiple-objects-表面法线和多个物体"><span class="toc-number">6.</span> <span class="toc-text">Surface
Normals and Multiple Objects 表面法线和多个物体</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#moving-canera-code-into-a-class-将相机代码移入类"><span class="toc-number">7.</span> <span class="toc-text">Moving Canera
Code into a Class 将相机代码移入类</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#antialiasing-抗锯齿"><span class="toc-number">8.</span> <span class="toc-text">Antialiasing 抗锯齿</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#diffuse-materials-漫反射材质"><span class="toc-number">9.</span> <span class="toc-text">Diffuse Materials 漫反射材质</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#metal-金属材质"><span class="toc-number">10.</span> <span class="toc-text">Metal 金属材质</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dielectrics-介质"><span class="toc-number">11.</span> <span class="toc-text">Dielectrics 介质</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#positionable-camera-可定位相机"><span class="toc-number">12.</span> <span class="toc-text">Positionable Camera
可定位相机</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#defocus-blur-散焦模糊"><span class="toc-number">13.</span> <span class="toc-text">Defocus Blur 散焦模糊</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#where-next-下一步做什么"><span class="toc-number">14.</span> <span class="toc-text">Where Next? 下一步做什么？</span></a></li></ol></div></div><div class="post-toc-toggle-wrap open" id="right-toggle"><div class="post-toc-toggle-first post-toc-toggle"></div><div class="post-toc-toggle-second post-toc-toggle"></div><div class="post-toc-toggle-thrid post-toc-toggle"></div></div><script type="text/javascript" src="/blog/js/sidebar.js?v=0.0.0" async></script></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/blog/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/blog/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/blog/css/copycode.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], processClass: 'math', processEscapes: true },
  TeX: {equationNumbers: { autoNumber: ['AMS'], useLabelIds: true }},
  'HTML-CSS': { linebreaks: { automatic: true } },
  SVG: { linebreaks: { automatic: true } }
  });
</script><!--script(type='text/javascript', src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', async)--><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=0.0.0"></script><script>hljs.initHighlightingOnLoad();</script><script type="text/javascript" src="/blog/js/app.js?v=0.0.0"></script></div></body></html>